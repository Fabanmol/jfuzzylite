FUNCTION_BLOCK Sugeno-Tip-Calculator

VAR_INPUT
  FoodQuality: REAL;
  Service: REAL;
END_VAR

VAR_OUTPUT
  CheapTip: REAL;
  AverageTip: REAL;
  GenerousTip: REAL;
END_VAR

FUZZIFY FoodQuality
  ENABLED : TRUE;
  RANGE := (1.00000000 .. 10.00000000);
  TERM Bad := Trapezoid 0.00000000 1.00000000 3.00000000 7.00000000;
  TERM Good := Trapezoid 3.00000000 7.00000000 10.00000000 11.00000000;
END_FUZZIFY

FUZZIFY Service
  ENABLED : TRUE;
  RANGE := (1.00000000 .. 10.00000000);
  TERM Bad := Trapezoid 0.00000000 1.00000000 3.00000000 7.00000000;
  TERM Good := Trapezoid 3.00000000 7.00000000 10.00000000 11.00000000;
END_FUZZIFY

DEFUZZIFY CheapTip
  ENABLED : TRUE;
  RANGE := (5.00000000 .. 25.00000000);
  TERM Low := 10.00000000;
  TERM Medium := 15.00000000;
  TERM High := 20.00000000;
  METHOD : COGS;
  ACCU : ASUM;
  DEFAULT := nan;
END_DEFUZZIFY

DEFUZZIFY AverageTip
  ENABLED : TRUE;
  RANGE := (5.00000000 .. 25.00000000);
  TERM Low := 10.00000000;
  TERM Medium := 15.00000000;
  TERM High := 20.00000000;
  METHOD : COGS;
  ACCU : ASUM;
  DEFAULT := nan;
END_DEFUZZIFY

DEFUZZIFY GenerousTip
  ENABLED : TRUE;
  RANGE := (5.00000000 .. 25.00000000);
  TERM Low := 10.00000000;
  TERM Medium := 15.00000000;
  TERM High := 20.00000000;
  METHOD : COGS;
  ACCU : ASUM;
  DEFAULT := nan;
END_DEFUZZIFY

RULEBLOCK 
  ENABLED : TRUE;
  AND : EPROD;
  OR : ESUM;
  ACT : PROD;
  RULE 1 : if FoodQuality is extremely Bad and Service is extremely Bad then CheapTip is extremely Low and AverageTip is very Low and GenerousTip is Low
  RULE 2 : if FoodQuality is Good and Service is extremely Bad then CheapTip is Low and AverageTip is Low and GenerousTip is Medium
  RULE 3 : if FoodQuality is very Good and Service is very Bad then CheapTip is Low and AverageTip is Medium and GenerousTip is High
  RULE 4 : if FoodQuality is Bad and Service is Bad then CheapTip is Low and AverageTip is Low and GenerousTip is Medium
  RULE 5 : if FoodQuality is Good and Service is Bad then CheapTip is Low and AverageTip is Medium and GenerousTip is High
  RULE 6 : if FoodQuality is extremely Good and Service is Bad then CheapTip is Low and AverageTip is Medium and GenerousTip is very High
  RULE 7 : if FoodQuality is Bad and Service is Good then CheapTip is Low and AverageTip is Medium and GenerousTip is High
  RULE 8 : if FoodQuality is Good and Service is Good then CheapTip is Medium and AverageTip is Medium and GenerousTip is very High
  RULE 9 : if FoodQuality is very Bad and Service is very Good then CheapTip is Low and AverageTip is Medium and GenerousTip is High
  RULE 10 : if FoodQuality is very very Good and Service is very very Good then CheapTip is High and AverageTip is very High and GenerousTip is extremely High
END_RULEBLOCK

END_FUNCTION_BLOCK
